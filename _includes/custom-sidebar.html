{%- assign items = site[page.collection_name] | where: "lang", site.active_lang -%}

{%- assign catset = "" | split: "" -%}
{%- assign tagset = "" | split: "" -%}
{%- for d in items -%}
  {%- for c in d.categories -%}{%- unless catset contains c -%}{%- assign catset = catset | push: c -%}{%- endunless -%}{%- endfor -%}
  {%- for t in d.tags -%}{%- unless tagset contains t -%}{%- assign tagset = tagset | push: t -%}{%- endunless -%}{%- endfor -%}
{%- endfor -%}
{%- assign catset = catset | sort -%}
{%- assign tagset = tagset | sort -%}

<div class="filter-sidebar">
  <h3 class="filter-title">Filter by category</h3>
  <ul class="filter-list">
    {%- for c in catset -%}
    <li><label><input type="checkbox" class="cat-filter" value="{{ c }}"> {{ c }}</label></li>
    {%- endfor -%}
  </ul>

  <h3 class="filter-title" style="margin-top:1rem;">Filter by tag</h3>
  <ul class="filter-list">
    {%- for t in tagset -%}
    <li><label><input type="checkbox" class="tag-filter" value="{{ t }}"> {{ t }}</label></li>
    {%- endfor -%}
  </ul>

  <button id="clear-filters" type="button">Clear</button>
</div>
