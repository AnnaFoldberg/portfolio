{%- comment -%} Stream all items from the chosen collection, current language {%- endcomment -%}
{%- assign coll = site[page.collection_name] | where: "lang", site.active_lang -%}

<div id="stream">
  {%- for doc in coll -%}
  <article class="stream-card"
           data-cats="{{ doc.categories | join: ' ' }}"
           data-tags="{{ doc.tags | join: ' ' }}">
    <h2 class="stream-title">{{ doc.title }}</h2> <!-- no hyperlink -->

    <div class="stream-meta">
      {%- assign has_cats = doc.categories | size | gt: 0 -%}
      {%- assign has_tags = doc.tags | size | gt: 0 -%}

      {%- if has_cats -%}
        <span class="taxonomy-label">Categories</span>
        <ul class="taxonomy-list">
          {%- for c in doc.categories -%}
            <li>{{ c }}</li>
          {%- endfor -%}
        </ul>
      {%- endif -%}

      {%- if has_cats and has_tags -%}
        <span class="taxonomy-sep" aria-hidden="true"></span>
      {%- endif -%}

      {%- comment -%} DEBUG: show tags as plain text to verify they’re present {%- endcomment -%}
      <span class="taxonomy-label">Tags</span>
      {%- if has_tags -%}
        <span class="taxonomy-inline">{{ doc.tags | join: ' · ' }}</span>
      {%- else -%}
        <span class="taxonomy-inline">(none)</span>
      {%- endif -%}

      {%- comment -%}
        DEBUG raw arrays (check in View Source):
        cats={{ doc.categories | jsonify }}
        tags={{ doc.tags | jsonify }}
      {%- endcomment -%}
    </div>

    <div class="stream-body">
      {{ doc.content }}
    </div>

    <hr class="stream-divider"/>
  </article>
  {%- endfor -%}
</div>
