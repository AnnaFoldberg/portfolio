{%- comment -%}
Breadcrumb (polyglot-aware)
- Strips language segment (en/da/it)
- Renders for both index pages (e.g., /da/projects/) and deep pages (/da/projects/foo/)
- Localizes Home and known segments via _data/locales/<lang>.yml:
    breadcrumb:
      home: "Home"
      segment_labels:
        projects: "Projects"
        notes: "Notes"
        log: "Log"
{%- endcomment -%}

{%- assign L = site.data.locales[site.active_lang].breadcrumb -%}
{%- assign home_label = L.home | default: "Home" -%}

{%- assign raw_segments = page.url | split:'/' -%}
{%- assign segments = "" | split:"" -%}
{%- for seg in raw_segments -%}
  {%- if seg and seg != "" and seg != site.active_lang -%}
    {%- assign segments = segments | push: seg -%}
  {%- endif -%}
{%- endfor -%}

{%- comment -%}
Show a breadcrumb when:
- there is at least one real URL segment, OR
- it's a collection index page (page.collection_name is set)
{%- endcomment -%}
{%- if segments.size > 0 or page.collection_name -%}
  {%- assign lang_home = '/' | append: site.active_lang | append: '/' -%}
  <nav class="breadcrumb">
    <a href="{{ lang_home | relative_url }}">{{ home_label }}</a>

    {%- assign path = "" -%}
    {%- for seg in segments -%}
      {%- assign path = path | append:'/' | append: seg -%}
      {%- assign label = seg | replace:'-',' ' | capitalize -%}
      {%- if L.segment_labels and L.segment_labels[seg] -%}
        {%- assign label = L.segment_labels[seg] -%}
      {%- endif -%}

      {%- if forloop.last -%}
        &nbsp;/&nbsp;<span class="crumb-current">{{ page.title | default: label }}</span>
      {%- else -%}
        &nbsp;/&nbsp;<a href="{{ path | relative_url }}">{{ label }}</a>
      {%- endif -%}
    {%- endfor -%}

    {%- comment -%} Index page: no segments â€” show current page title as the only crumb after Home {%- endcomment -%}
    {%- if segments.size == 0 and page.collection_name -%}
      &nbsp;/&nbsp;<span class="crumb-current">{{ page.title }}</span>
    {%- endif -%}
  </nav>
{%- endif -%}
